# !/usr/bin/env python3
#
# script name:  Signature-based Malware Detection Part 1 of 3
# author:       ben_podawiltz
# revision:     9.28.21
#
######################################


##########################
#
# Libraries
import os
import logging 


##########################################

# file_str = "dummmy.txt"
file_str = input("Please enter file name for search: ")
# dir_str = "/home/benjamin/dummy/"  
dir_str = input("Please enter directory for search: ")   

def linuxSearch(file_str, dir_str):
    malicious = []
    filecount = 0
    print(len(malicious))
    for root, dir, files in os.walk(dir_str):
        print('Searching for in:',root)
        filecount += 1
        if file_str in files:
            matchPath =  os.path.join(root,file_str)
            malicious.append(matchPath)
            print("Found file: ", file_str, "Found Path: ", matchPath)
    if len(malicious) == 0:
        print("File Not Found")
    print("Files searched: ", filecount, "Hits Found: ", len(malicious))
    print(malicious)



if __name__=='__main__':
    linuxSearch(file_str, dir_str)

##################################################


#
#Resource: https://geeksforgeeks.org/os-module-python-examples/




#End